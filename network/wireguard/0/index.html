<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>[Wireguard] Wireguard 사용 예시 | 論作室</title>
  <meta name="description" content="PngWnA&#39;s blog" />
  <meta name="keywords" content="Blog,Computer Science,Computer Engineering,Mathematics,Amateur Astronomy" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" href="/images/blog/favicon.ico">
  <link rel="alternate" href="/atom.xml" title="論作室" type="application/atom+xml">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="사용 환경지금 사용하는 컴퓨터들은 아래 그림과 같은 곳에 설치되어있습니다.  컴퓨터 구성 예시  밖에서는 노트북(PC2)를 이용하여 주로 집 서버에 접속해서 작업을 진행합니다. 집 서버는 사설 IP(192.168.0.2)를 배정받지만 공유기에서 DMZ를 설정해놓았기 때문에 공인 IP(58.142.x.x)를 배정받은 경우처럼 작동합니다. 집 서버가 아닌 경우">
<meta property="og:type" content="article">
<meta property="og:title" content="[Wireguard] Wireguard 사용 예시">
<meta property="og:url" content="https://pngwna.github.io/network/wireguard/0/index.html">
<meta property="og:site_name" content="論作室">
<meta property="og:description" content="사용 환경지금 사용하는 컴퓨터들은 아래 그림과 같은 곳에 설치되어있습니다.  컴퓨터 구성 예시  밖에서는 노트북(PC2)를 이용하여 주로 집 서버에 접속해서 작업을 진행합니다. 집 서버는 사설 IP(192.168.0.2)를 배정받지만 공유기에서 DMZ를 설정해놓았기 때문에 공인 IP(58.142.x.x)를 배정받은 경우처럼 작동합니다. 집 서버가 아닌 경우">
<meta property="og:locale">
<meta property="og:image" content="https://pngwna.github.io/images/network/wireguard/1.jpg">
<meta property="article:published_time" content="2022-07-19T08:19:10.000Z">
<meta property="article:modified_time" content="2022-07-22T10:35:16.512Z">
<meta property="article:author" content="PngWnA">
<meta property="article:tag" content="wireguard">
<meta property="article:tag" content="VPN">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pngwna.github.io/images/network/wireguard/1.jpg">
    
  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Titillium+Web" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link href='//cdn.bootcss.com/node-waves/0.7.5/waves.min.css' rel='stylesheet'>
  
<link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/kopubbatang.css">

  
<link rel="stylesheet" href="/style.css">

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-139965438-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-139965438-1');
</script>
<meta name="google-site-verification" content="-ZJXL16irbPYRLwYOlckuTa-QeUinxCQ2W-uOszlU1c" />
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <script>setLoadingBarProgress(20)</script> 
  <header class="l_header">
	<div class='wrapper'>
		<div class="nav-main container container--flex">
			<a class="logo flat-box" href='/' >
				論作室
			</a>
			<div class='menu'>
				<ul class='h-list'>
					
						<li>
							<a class='flat-box nav-home' href='/'>
								Home
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-about' href='/about'>
								About
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-archives' href='/archives'>
								Archives
							</a>
						</li>
					
				</ul>
				<div class='underline'></div>
			</div>
			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search" />
						<span class="icon icon-search"></span>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a href='javascript:void(0)'><span class="icon icon-search flat-box"></span></a></li>
				
				<li class='s-menu'><a href='javascript:void(0)'><span class="icon icon-menu flat-box"></span></a></li>
			</ul>
		</div>
		
		<div class='nav-sub container container--flex'>
			<a class="logo" class="flat-box" href='javascript:void(0)'>
				Word of Forks
			</a>

			<ul class='switcher h-list'>
				<li class='s-comment'><a href='javascript:void(0)'><span class="icon icon-chat_bubble_outline flat-box"></span></a></li>
				<li class='s-top'><a href='javascript:void(0)'><span class="icon icon-arrow_upward flat-box"></span></a></li>
				<li class='s-toc'><a href='javascript:void(0)'><span class="icon icon-format_list_numbered flat-box"></span></a></li>
			</ul>
		</div>
	</div>
</header>
<aside class="menu-phone">
	<nav>
		
			<a href="/" class="nav-home nav">
				Home
			</a>
		
			<a href="/about" class="nav-about nav">
				About
			</a>
		
			<a href="/archives" class="nav-archives nav">
				Archives
			</a>
		
	</nav>
</aside>

    <script>setLoadingBarProgress(40);</script>
  <div class="l_body">
    <div class='container clearfix'>
      <div class='l_main'>
        <article id="post-network/wireguard/0"
  class="post white-box article-type-post"
  itemscope itemprop="blogPost">
	<section class='meta'>
	<h2 class="title">
  	<a href="/network/wireguard/0/">
    	[Wireguard] Wireguard 사용 예시
    </a>
  </h2>
	<time>
	  Jul 19, 2022
	</time>
	
    
    <div class='cats'>
        <a href="/categories/Network/">Network</a>, <a href="/categories/Network/wireguard/">wireguard</a>
    </div>

	</section>
	
		<section class="toc-wrapper"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%EC%82%AC%EC%9A%A9-%ED%99%98%EA%B2%BD"><span class="toc-number">1.</span> <span class="toc-text">사용 환경</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%ED%8C%A8%ED%82%A4%EC%A7%80-%EC%84%A4%EC%B9%98"><span class="toc-number">2.</span> <span class="toc-text">패키지 설치</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ubuntu"><span class="toc-number">2.1.</span> <span class="toc-text">Ubuntu</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Arch-Linux"><span class="toc-number">2.2.</span> <span class="toc-text">Arch Linux</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%ED%82%A4-%EC%83%9D%EC%84%B1"><span class="toc-number">3.</span> <span class="toc-text">키 생성</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EC%84%A4%EC%A0%95%ED%8C%8C%EC%9D%BC-%EC%83%9D%EC%84%B1"><span class="toc-number">4.</span> <span class="toc-text">설정파일 생성</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#VPN-%EC%84%9C%EB%B2%84"><span class="toc-number">4.1.</span> <span class="toc-text">VPN 서버</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VPN-%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8"><span class="toc-number">4.2.</span> <span class="toc-text">VPN 클라이언트</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#wireguard-%ED%99%9C%EC%84%B1%ED%99%94"><span class="toc-number">5.</span> <span class="toc-text">wireguard 활성화</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EC%B0%B8%EA%B3%A0"><span class="toc-number">6.</span> <span class="toc-text">참고</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#vanity-key"><span class="toc-number">6.1.</span> <span class="toc-text">vanity key</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">6.2.</span> <span class="toc-text">Reference</span></a></li></ol></li></ol></section>
	
	<section class="article typo">
  	<div class="article-entry" itemprop="articleBody">
    	<h1 id="사용-환경"><a href="#사용-환경" class="headerlink" title="사용 환경"></a>사용 환경</h1><p>지금 사용하는 컴퓨터들은 아래 그림과 같은 곳에 설치되어있습니다.</p>
<p><img src="/images/network/wireguard/1.jpg"></p>
<center>컴퓨터 구성 예시</center>

<p>밖에서는 노트북(PC2)를 이용하여 주로 집 서버에 접속해서 작업을 진행합니다. 집 서버는 사설 IP(192.168.0.2)를 배정받지만 공유기에서 DMZ를 설정해놓았기 때문에 공인 IP(58.142.x.x)를 배정받은 경우처럼 작동합니다.</p>
<p>집 서버가 아닌 경우에는 다음과 같은 이유로 SSH를 이용한 접속에 문제가 발생합니다.</p>
<ul>
<li>방화벽이 설정된 경우(학교서버, PC1): 인바운드 연결이 불가능</li>
<li>IP가 유동적이거나 사설 IP를 배정받은 경우(PC2, 노트북에 SSH로 접속할 경우는 많이 없음): IP를 모르거나 해당 IP로 연결이 불가능</li>
</ul>
<p>기존에는 reverse SSH같은 방법을 사용해서 문제를 해결했으나, wireguard를 이용하는 방식으로 수정했습니다</p>
<p>wireguard를 사용하면 각각의 컴퓨터가 하나의 공유기 안에 연결되어있는 것처럼 네트워크를 구성할 수 있습니다.</p>
<h1 id="패키지-설치"><a href="#패키지-설치" class="headerlink" title="패키지 설치"></a>패키지 설치</h1><p>wireguard 자체는 Linux 커널에 이미 포함이 되어있기 때문에, wireguard를 편하게 쓸 수 있는 <code>wireguard-tools</code>을 설치합시다.</p>
<h2 id="Ubuntu"><a href="#Ubuntu" class="headerlink" title="Ubuntu"></a>Ubuntu</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install wireguard-tools</span><br></pre></td></tr></table></figure>
<h2 id="Arch-Linux"><a href="#Arch-Linux" class="headerlink" title="Arch Linux"></a>Arch Linux</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacman -S wireguard-tools</span><br></pre></td></tr></table></figure>

<p>윈도우(wireguard 설치 필요) 및 기타 배포판은 <a target="_blank" rel="noopener" href="https://www.wireguard.com/install/">wireguard 홈페이지</a>를 참고합시다.</p>
<h1 id="키-생성"><a href="#키-생성" class="headerlink" title="키 생성"></a>키 생성</h1><p>wireguard는 각 컴퓨터에서 생성한 키쌍(공개키, 개인키)를 이용하여 VPN 터널을 구축하기 때문에 컴퓨터 하나당 키쌍 하나를 생성해야합니다.</p>
<p>공식 홈페이지에서는 다음과 같이 키쌍을 생성하라고 메뉴얼에서 언급하고 있습니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">umask</span> 077 <span class="comment"># 생성될 키의 퍼미션 설정, 생략해도 정상적으로는 작동</span></span><br><span class="line">wg genkey &gt; privatekey <span class="comment"># 개인키 생성</span></span><br><span class="line">wg pubkey &lt; privatekey &gt; publickey <span class="comment"># 개인키를 이용하여 공개키 생성</span></span><br></pre></td></tr></table></figure>

<p>개인키와 공개키를 성공적으로 생성했다면 다음과 같이 base64형태의 문자열이 저장된 것을 확인할 수 있습니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pngwna@ArchPngWnA ~/sandbox % <span class="built_in">cat</span> privatekey publickey </span><br><span class="line">AOQ/mKof+blb60wF4nxMqM2i1CKmVwLunNbUwOZi93s=</span><br><span class="line">zVXVrTkaOHI9WqnEHJyxdewt1fYRWxCHObIJ3jDtI2A=</span><br></pre></td></tr></table></figure>

<p>wireguard를 사용하는 컴퓨터마다 키 생성을 진행해줍시다.</p>
<h1 id="설정파일-생성"><a href="#설정파일-생성" class="headerlink" title="설정파일 생성"></a>설정파일 생성</h1><p>다음과 같이 VPN 내부 IP를 설정하는 경우의 예시입니다.</p>
<ul>
<li>집 서버(58.142.x.x) &lt;- 10.0.0.1</li>
<li>학교 서버(163.152.x.x) &lt;- 10.0.0.2</li>
<li>학교 PC1(58.142.x.x) &lt;- 10.0.0.4</li>
<li>외부 PC2(58.142.x.x) &lt;- 10.0.0.5</li>
</ul>
<p>키 생성을 통해서 각 컴퓨터마다 하나의 키쌍(공개키, 개인키)를 생성해두었습니다. 이를 이용하여 설정파일을 생성합시다.</p>
<h2 id="VPN-서버"><a href="#VPN-서버" class="headerlink" title="VPN 서버"></a>VPN 서버</h2><p>공인 IP를 배정받은 서버를 이용해 여러 컴퓨터를 하나로 묵을 수 있습니다.</p>
<p>만약 공인 IP를 배정받을 수 있는 서버가 없다면, 프리티어 VM을 사용하는 것도 해결책이 될 수 있습니다.</p>
<p>서버로 사용할 컴퓨터의 <code>/etc/wireguard/</code> 아래 다음과 같이 설정파일(예시:<code>wg0.conf</code>)를 추가해줍니다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[Interface]</span><br><span class="line">Address = 10.0.0.1/32</span><br><span class="line">SaveConfig = true</span><br><span class="line">ListenPort = 7777</span><br><span class="line">PrivateKey = ------------------------------------------ # 위에서 생성한 서버(10.0.0.1)의 개인키</span><br><span class="line"></span><br><span class="line">[Peer]</span><br><span class="line">PublicKey = ----------------------------------------- # 학교 서버(10.0.0.2)의 공개키</span><br><span class="line">AllowedIPs = 10.0.0.2/32</span><br><span class="line">PersistentKeepalive = 15</span><br><span class="line"></span><br><span class="line">[Peer]</span><br><span class="line">PublicKey = ----------------------------------------- # 학교 PC1(10.0.0.4)의 공개키</span><br><span class="line">AllowedIPs = 10.0.0.4/32</span><br><span class="line"></span><br><span class="line">[Peer]</span><br><span class="line">PublicKey = ----------------------------------------- # 외부 PC2(10.0.0.5)의 공개키</span><br><span class="line">AllowedIPs = 10.0.0.5/32</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p><code>[Interface]</code>에는 해당 컴퓨터의 개인키, <code>[Peer]</code>에는 대상 컴퓨터의 공개키를 넣어야하는 점을 기억합시다. 잘못 넣으면 연결이 되지 않습니다.</p>
<p>각 요소에 대한 설명은 다음과 같습니다.</p>
<ul>
<li>Address: 해당 컴퓨터가 배정받고자 하는 IP</li>
<li>Saveconfig: 변경 사항을 자동으로 해당 설정 파일에 반영할지 여부</li>
<li>ListenPort: wireguard 서버 포트</li>
<li>PrivateKey: 해당 컴퓨터의 개인키</li>
<li>PublicKyey: 대상 컴퓨터의 공개키</li>
<li>AllowedIPs: 접속이 허용되는 IP대역(각각의 IP로만 10.0.0.1에 접속이 가능함)</li>
<li>PersistentKeepAlive: 몇초마다 keepalive 패킷을 보낼지 인터벌 설정</li>
</ul>
<h2 id="VPN-클라이언트"><a href="#VPN-클라이언트" class="headerlink" title="VPN 클라이언트"></a>VPN 클라이언트</h2><p>서버를 제외한, VPN을 사용하려고 하는 컴퓨터마다 다음과 같이 <code>/etc/wireguard/</code>에 설정파일(예시:<code>wg0.conf</code>)를 만들어줍니다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[Interface]</span><br><span class="line">Address = 10.0.0.2/32</span><br><span class="line">PrivateKey = ----------------------------------------- # 외부 PC2(10.0.0.2)의 공개키</span><br><span class="line"></span><br><span class="line">[Peer]</span><br><span class="line">PublicKey = ------------------------------------------ # 위에서 생성한 서버(10.0.0.1)의 개인키</span><br><span class="line">AllowedIPs = 10.0.0.0/8 #10.x.x.x에 해당하는 패킷은 전부 이 피어로 전달</span><br><span class="line">Endpoint = 58.142.x.x:7777 # 서버 IP : 위에서 설정한 ListenPort</span><br><span class="line">PersistentKeepalive = 15 # 15초마다 keepalive 패킷 전송</span><br></pre></td></tr></table></figure>
<p><code>[Interface]</code>에는 해당 컴퓨터의 개인키, <code>[Peer]</code>에는 대상 컴퓨터의 공개키를 넣어야하는 점을 다시 한 번 기억합시다.</p>
<p>AllowedIPs를 10.0.0.0&#x2F;8로 설정할 경우 10.x.x.x에 매치되는 모든 연결은 VPN서버로 연결된 후 목적지 IP로 다시 라우팅됩니다. 이를 이용하여 wireguard VPN을 사용하는 컴퓨터를 하나의 네트워크 아래로 묶을 수 있습니다.</p>
<p>클라이언트마다 위와 같은 설정 파일을 생성해줍시다.</p>
<p>이렇게 설정파일을 설정할 경우 위에서 언급한 두가지 문제가 해결 됩니다.</p>
<ul>
<li>방화벽이 설정된 경우: PersistentKeepAlive 설정으로 내부에서 연결을 시작할 수 있기 때문에 우회 가능</li>
<li>IP가 유동적이거나 사설 IP를 배정받은 경우: 설정한 IP(10.0.0.x)로 접근 가능하기 때문에 해결 가능</li>
</ul>
<h1 id="wireguard-활성화"><a href="#wireguard-활성화" class="headerlink" title="wireguard 활성화"></a>wireguard 활성화</h1><p>다음과 같은 명령어로 wireguard VPN을 활성화합시다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wg-quick up wg0.conf</span><br></pre></td></tr></table></figure>
<p>(윈도우같은 경우는 설정파일을 추가해준 후 activate를 클릭하면 터널이 활성화됩니다)</p>
<p><code>wg-quick up</code> 뒤에는 설정한 파일 이름이 들어가야합니다. 만약 설정 파일을 <code>wgserver.conf</code>로 만들었다면 명령어는</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wg-quick up wgserver.conf</span><br></pre></td></tr></table></figure>
<p>가 되어야 합니다.</p>
<p>활성화 후 <code>wg</code> 명령어를 이용하여 터널링이 제대로 활성화되었는지 확인할 수 있습니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">root@Polaris$ sudo wg</span><br><span class="line"></span><br><span class="line">interface: wgserver</span><br><span class="line">  public key: RamenwxjwwmCp7z6uGxHCW7nFWOwRs1UMNanhJNCpiw=</span><br><span class="line">  private key: (hidden)</span><br><span class="line">  listening port: 7777</span><br><span class="line"></span><br><span class="line">peer: LabFLZped7Cv9CDjU6SQudVH/Al+AihNLjvKuIRiG2E=</span><br><span class="line">  endpoint: 163.152.x.x:41164</span><br><span class="line">  allowed ips: 10.0.0.4/32</span><br><span class="line">  latest handshake: 44 seconds ago</span><br><span class="line">  transfer: 22.08 MiB received, 110.19 MiB sent</span><br><span class="line"></span><br><span class="line">peer: gram/SUGOPwbZq0ggN42XlMROAxyP8ZIey9XEhObUW4=</span><br><span class="line">  endpoint: 163.152.x.x:41621</span><br><span class="line">  allowed ips: 10.0.0.5/32</span><br><span class="line">  latest handshake: 53 seconds ago</span><br><span class="line">  transfer: 18.06 MiB received, 93.89 MiB sent</span><br><span class="line"></span><br><span class="line">peer: Home75VA21rBOQUX+TyHT2TCzY7Q/7e7byTWSQosPAE=</span><br><span class="line">  endpoint: 192.168.x.x:59810</span><br><span class="line">  allowed ips: 10.0.0.3/32</span><br><span class="line">  latest handshake: 1 minute, 1 second ago</span><br><span class="line">  transfer: 131.61 MiB received, 29.96 MiB sent</span><br><span class="line"></span><br><span class="line">peer: KUAAA7/P6IPRSMw/aMEvbVw406ok0j1AU8ENf+A85U0=</span><br><span class="line">  endpoint: 163.152.x.x:60520</span><br><span class="line">  allowed ips: 10.0.0.2/32</span><br><span class="line">  latest handshake: 1 minute, 32 seconds ago</span><br><span class="line">  transfer: 43.73 MiB received, 6.32 MiB sent</span><br><span class="line">  persistent keepalive: every 15 seconds</span><br></pre></td></tr></table></figure>

<p>클라이언트에서도 마찬가지로 <code>wg</code> 명령어를 사용하여 터널링 상태를 확인할 수 있습니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">pngwna@ArchPngWnA ~/sandbox % sudo wg</span><br><span class="line"></span><br><span class="line">interface: wg0</span><br><span class="line">  public key: gram/SUGOPwbZq0ggN42XlMROAxyP8ZIey9XEhObUW4=</span><br><span class="line">  private key: (hidden)</span><br><span class="line">  listening port: 41621</span><br><span class="line"></span><br><span class="line">peer: RamenwxjwwmCp7z6uGxHCW7nFWOwRs1UMNanhJNCpiw=</span><br><span class="line">  endpoint: 58.142.x.x:7777</span><br><span class="line">  allowed ips: 10.0.0.0/8</span><br><span class="line">  latest handshake: 45 seconds ago</span><br><span class="line">  transfer: 107.30 MiB received, 28.72 MiB sent</span><br></pre></td></tr></table></figure>

<p>wireguard가 제대로 설정된 것 같으면 다음과 같은 명령어로 컴퓨터 시작시 항상 실행되게 설정합시다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable wg-quick@wg0.service</span><br></pre></td></tr></table></figure>
<p>(<code>wg-quick@</code> 뒤에는 <code>설정파일이름.service</code>와 같은 형태로 입력하면 됩니다)</p>
<p>위와 같이 설정하면 컴퓨터간 wireguard VPN 터널링을 정상적으로 활용할 수 있습니다.</p>
<h1 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h1><h2 id="vanity-key"><a href="#vanity-key" class="headerlink" title="vanity key"></a>vanity key</h2><p>wg genkey로 생성되는 키는 보통 의미 없는 base64 문자열이지만 계속 키를 생성하다보면 의미있는 문자열이 나올 수 도 있습니다.</p>
<p><a target="_blank" rel="noopener" href="https://github.com/axllent/wireguard-vanity-keygen">wireguard vanity keygen</a>을 이용하면 본인이 원하는 문자열로 시작하는 공개키(예시: <code>Home75VA21rBOQUX+TyHT2TCzY7Q/7e7byTWSQosPAE=</code>) 를 생성할 수 있습니다.</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.wireguard.com/">wireguard</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/axllent/wireguard-vanity-keygen">wireguard vanity keygen</a></li>
</ul>

  	</div>
	  
	  <div class="article-tags tags">
      
        <a href="/tags/wireguard/">wireguard</a>
      
        <a href="/tags/VPN/">VPN</a>
      
	  </div>
    
		
	
		<div class="art-item-footer">
				
				
					<span class="art-item-right">next:<a href="/review/979-11-6592-146-0/" rel="next"  title="[리뷰] 0.1%의 승부, 소프트웨어로 분석하는 선거 개표방송">
						[리뷰] 0.1%의 승부, 소프트웨어로 분석하는 선거 개표방송
					</a><i class="icon icon-chevron-thin-right"></i></span>
				
		</div>
	
	
	</section>
	
</article>
<script>
	window.subData = {
		title: '[Wireguard] Wireguard 사용 예시',
		tools: true
	}
</script>

      </div>
      <aside class='l_side'>
        
  <section class='m_widget about'>

<img class='avatar waves-image' src='/images/blog/avatar.jpg' />

<div class='header'>PngWnA</div>
<div class='content'>
    <div class='desc'>온라인 낙서장</div>
</div>
</section>

  <section class='m_widget categories'>
<div class='header'>Categories</div>
<div class='content'>
    <ul class="entry">
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Amateur-Astronomy/">Amateur Astronomy</a><span class="category-list-count">59</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Amateur-Astronomy/%EA%B4%80%EC%B8%A1%EC%9D%BC%EC%A7%80/">관측일지</a><span class="category-list-count">59</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Develop/">Develop</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Develop/0-%ED%94%8C%EB%9D%BC%EB%84%A4%ED%83%80%EB%A6%AC%EC%9B%80-%EA%B5%AC%ED%98%84%EA%B8%B0/">#0. 플라네타리움 구현기</a><span class="category-list-count">6</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Network/">Network</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Network/wireguard/">wireguard</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%EC%B1%85-%EB%A6%AC%EB%B7%B0/">책 리뷰</a><span class="category-list-count">1</span></li></ul>
    </ul>
</div>
</section>

      </aside>
      <script>setLoadingBarProgress(60);</script>
    </div>
  </div>
  <footer id="footer" class="clearfix">

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/PngWnA" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="/atom.xml" class="social rss"
          target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
    
  </div>
  
  <div>Theme <a target="_blank" rel="noopener" href='https://github.com/stkevintan/hexo-theme-material-flow' class="codename">MaterialFlow</a> designed by <a href="http://keyin.me/" target="_blank">Kevin Tan</a>.</div>
  <div>Customization by <a href='https://github.com/PngWnA/material-flow' target="_blank">PngWnA</a></div>
  
</footer>


  <script>setLoadingBarProgress(80);</script>
  

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src='//cdn.bootcss.com/node-waves/0.7.5/waves.min.js'></script>
<script src="//cdn.bootcss.com/scrollReveal.js/3.3.2/scrollreveal.min.js"></script>

<script src="/js/jquery.fitvids.js"></script>

<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "hexo";
  var ROOT = "/"||"/";
  if(!ROOT.endsWith('/'))ROOT += '/';
</script>

<script src="/js/search.js"></script>


<script src="/js/app.js"></script>



  <script>setLoadingBarProgress(100);</script>
</body>
</html>
